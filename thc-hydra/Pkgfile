# Description: Network logon cracker
# URL:         https://github.com/vanhauser-thc/thc-hydra
# Depends on:  freerdp2 gtk libidn libssh mysql postgresql

name=thc-hydra
version=9.1
release=1
source=(https://github.com/vanhauser-thc/$name/archive/v$version/$name-v$version.tar.gz)

build() {
	cd $name-$version

	sed -i 's/ -O3 / /g' Makefile.am

	./configure --prefix=$PKG/usr

	make CFLAGS="$CFLAGS -fcommon"     # add -fcommon to fix xhydra build
	make MANDIR=/share/man install

	# Move password lists
	mkdir -p $PKG/usr/share/hydra
	mv $PKG/usr/etc/* $PKG/usr/share/hydra
	rm -rf $PKG/usr/etc

	#  Fix paths in dpl4hydra.sh
	sed -i -e "s|^INSTALLDIR=.*|INSTALLDIR=/usr|" $PKG/usr/bin/dpl4hydra.sh
	sed -i -e "s|^LOCATION=.*|LOCATION=share/hydra|" $PKG/usr/bin/dpl4hydra.sh
}
