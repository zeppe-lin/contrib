# Description: Image loading library for GTK+
# URL:         https://wiki.gnome.org/Projects/GdkPixbuf
# Depends on:  glib libpng libtiff

name=gdk-pixbuf
version=2.42.6
release=1
source=(http://download.gnome.org/sources/$name/${version:0:4}/$name-$version.tar.xz
	gdk-pixbuf-register.sh)

build() {
	export DESTDIR=$PKG

	# disable tests
	sed -i "/subdir('tests')/d" $name-$version/meson.build

	meson $name-$version build \
		--prefix=/usr            \
		--buildtype=plain        \
		-D builtin_loaders=all   \
		-D docs=false            \
		-D gio_sniffing=false    \
		-D gir=false             \
		-D installed_tests=false \
		-D jasper=false          \
		-D man=false             \
		-D png=true              \

	ninja -C build -v
	ninja -C build -v install

	install -m 755 -D $SRC/gdk-pixbuf-register.sh \
		$PKG/usr/bin/gdk-pixbuf-register
}
